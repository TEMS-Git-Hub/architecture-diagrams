@startuml

title OpenID Connect authorization code flow\n(OpenID Core 1.0, sec. 3.1.1)

Actor User as U
Participant App as UA
Participant "AS/IdP" as AS
Participant "Resource\n(e.g. EDC Administration Endpoint)" as R

U -> UA: Click connexion link
UA -> AS: GET /.well-known/.well-known/openid-configuration
AS -> UA: Discovery Data
UA -> UA: Extract authorization_endpoint and token_endpoint
UA -> AS: GET/POST authorization_endpoint\nCallback URL
AS -> UA: 302 - Redirect Authentication wiew
UA -> AS: Follow redirect
AS -> U:  Authentication wiew
U  -> AS: Enter credentials
AS -> UA: 302 - Redirect to Callback URL\nwith Auth. Code
UA -> UA: Extract Auth. Code
UA -> AS: POST token_endpoint\ngrant_type=authorization_code, code=auth_code, ...\n(RFC 6749, 4.1.3)
AS -> AS: Validate auth_code\n(OIDC1.0, 3.1.3.2)
AS -> UA: access_token, id_token, refresh_token\n(OIDC1.0, 3.1.3.3)

UA -> R: Access resource with access_token

@enduml